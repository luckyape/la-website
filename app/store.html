<!doctype html>
<html lang="">

<head>
  <!-- @include includes/header.html -->
</head>

<body class="la-store-page">
  <!-- @include includes/navbar.html -->
  <div id="la-content-wrapper" class="la-content-wrapper">
    <div class="container">
      <div class="row">
        <div class="col center s10 offset-s1 flow-text">
          <h1 class="extra-padding-height flow-text">Company Store             
                </h1>
          <div class="show-on-small center toggle-filter">
            <a>
                <span class="show-filter">Show</span>
                <span class="hide-filter">Hide</span> Filters<i class="material-icons">filter_list</i>
             </a>
          </div>
        </div>
      </div>
      <div class="row tap-target-row">
        <div class="tap-target" data-activates="store-tap-target">
          <div class="tap-target-content">
            <h5>What Is Going On Here?</h5>
            <p>Use the <span class="chip sample" style="display: inline-block; ">chipies<i class="material-icons close">close</i></span>to filter store items.</p>
            <p>Chipies can be added, removed or highlighted.</p>
          </div>
        </div>
        <a id="store-tap-target" class="info-spot store-tap-target green waves-effect waves-light btn btn-floating">
                <i class="material-icons">menu</i>
            </a>
      </div>
      <div class="row products-filter">
        <div class="right">
          <a id="info-spot" class="info-spot right green waves-effect waves-light btn btn-floating question-mark">?</a>
        </div>
        <div id="productsChips" class="products chips"></div>
      </div>
    </div>
    <div class="container">
      <div id="productsCards" class="product-cards row">
        <div class="grid-sizer"></div>
        <div class="gutter-sizer"></div>
        <!-- @include includes/store-products.html -->
      </div>
    </div>
    <!-- @include includes/footer.html -->
  </div>
  <!--  Scripts-->
  <!-- @include includes/global-js.html -->
  <!-- build:js scripts/main.min.js -->
  <script type="text/javascript" src="scripts/main.js"></script>
  <script type="text/javascript" src="scripts/init.js"></script>
  <!-- endbuild -->
  <script>
  (function($) {
    $(function() {
      var filters = { chips: [] },
        $grid = $('#productsCards'),
        $chips = {},
        chipsArr = [],
        chipsObj = {},
        testTouch = function() {
          var el = document.createElement('div');
          el.setAttribute('ontouchstart', 'return;'); // or try "ontouchstart"
          return typeof el.ongesturestart === "function";
        },
        matchMedia = function() {
          if (probPhone) {
            if ($grid.hasClass('isotope')) {
              $grid.isotope('destroy');
            }
            if (!$grid.flickity) {
              async(['/scripts/lib/flickity/dist/flickity.pkgd.min.js'], flickityInit);
            } else {
              setTimeout(flickityInit, 100);
            }
          } else {
            if ($grid.hasClass('flickity-enabled')) {
              $grid.flickity('destroy');
            }

            if (!$grid.isotope) {
              async(['https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js'], function() {
                async(['/scripts/lib/isotope-packery/packery-mode.pkgd.min.js'], isotopeInit);
              })
            } else {
              setTimeout(isotopeInit, 100);
            }

          }
        },
        isotopeInit = function() {
          $grid.isotope({
            layoutMode: 'packery',
            packery: {
              columnWidth: '.grid-sizer',
              gutter: '.gutter-sizer'
            },
            itemSelector: '.grid-item',
            percentPosition: true,
            resize: true,
            filter: function() {

              var isMatched = true,
                $this = $(this);

              if (filters.selected) {
                isMatched = $($this[0]).hasClass(filters.selected);
              } else {
                filters.chips = $chips.material_chip('data').map(function(c) {
                  return c.id;
                });
                for (var i = 0; i < filters.chips.length; i++) {
                  if ($this[0].className.indexOf(filters.chips[i]) > -1) {
                    return true;
                  }
                }
                return false;
              }
              return isMatched;
            }
          });

        },
        flickityInit = function() {
          $($grid).flickity({
            cellSelector: '.grid-item',
            wrapAround: true,
            selectedAttraction: 0.2,
            friction: 0.8,
            resize: true,
            pageDots: false
          });
        },
        getChips = function(i, chip) {
          var chipText = $(chip).text().trim();
          if (chipsObj[chipText] !== null) {


            chipsArr.push({
              tag: chipText,
              id: chipText.trim().replace(/\s+/g, '-').toLowerCase()
            });

            chipsObj[chipText] = null;
          }

        },
        intiChips = function() {
          $chips = $('#productsChips');
          $chips.material_chip({
            data: chipsArr,
            placeholder: '...',
            autocompleteOptions: {
              data: chipsObj,
              limit: Infinity,
              minLength: 1
            }
          });
          $('input', $chips).focus();

          $chips.on('click', function(e) {

            if (filters.selected) {
              filters.selected = null;
              $grid.isotope();
            }

            //  chipsObj[chip.tag] = (chipsObj[chip.tag])? true : null;
          });
          $chips.on('chip.select', function(e, chip) {
            // you have the added chip here
            filters.selected = chip.tag;
            $grid.isotope();
          });

          $chips.on('chip.add', function(e, chip) {
            // you have the added chip here
            //console.info(e, chip);
            $grid.isotope();
          });
          $chips.on('chip.delete', function(e, chip) {
            // you have the deleted chip here
            //console.info(e, chip);
            $grid.isotope();
          });
        };

      $(window).resize(matchMedia);
      matchMedia();

      $('.card-chips .chip').each(getChips).promise().done(intiChips);

      $('.info-spot').click(function() {
        $('.tap-target').tapTarget('open');
      });

      $('.toggle-filter').click(function() {
        $('.products-filter,.toggle-filter').toggleClass('filter-on');
      });

    }); // end of document ready
  })(jQuery); // end of jQuery name space

  </script>
  <!-- endbuild -->
  <!-- Built with love using Web Starter Kit -->
</body>

</html>
